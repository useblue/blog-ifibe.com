<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>ASFCryptoPW</title><script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script><style>body{text-align:center}#box{margin:0 auto;border:1px solid #9f79ee;width:500px;height:100px}</style></head><body><div id="box"><div>password: <input id="password" type="text"></div><div>cryptkey: <input id="cryptkey" type="text"></div><div>encrypt: <input id="encrypt" type="text"></div><input type="button" value="encrypt" onclick="encryptClick()"> <input type="button" value="decrypt" onclick="decryptClick()"></div><script>const inputPassword=document.querySelector("#password"),inputCryptkey=document.querySelector("#cryptkey"),inputEncrypt=document.querySelector("#encrypt");function encryptClick(){inputEncrypt.value=SymmetricEncrypt(inputPassword.value,inputCryptkey.value)}function decryptClick(){inputPassword.value=SymmetricDecrypt(inputEncrypt.value,inputCryptkey.value)}function SymmetricEncrypt(r,t){if(void 0===r)throw new TypeError("input");if(void 0===t)throw new TypeError("key");const e=CryptoJS.SHA256(t),p=CryptoJS.lib.WordArray.random(16),o=CryptoJS.AES.encrypt(p,e,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.NoPadding}),y=CryptoJS.AES.encrypt(r,e,{iv:p});return CryptoJS.enc.Hex.parse(o.ciphertext+y.ciphertext).toString(CryptoJS.enc.Base64)}function SymmetricDecrypt(r,t){if(void 0===r)throw new TypeError("input");if(void 0===t)throw new TypeError("key");const e=CryptoJS.enc.Base64.parse(r).toString(),p=e.slice(32),o=e.slice(0,32),y=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Hex.parse(p)}),n=CryptoJS.SHA256(t),i=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Hex.parse(o)}),c=CryptoJS.AES.decrypt(i,n,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.NoPadding});return CryptoJS.AES.decrypt(y,n,{iv:c}).toString(CryptoJS.enc.Utf8)}</script></body></html>